<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zhenjie Liu" />

<meta name="date" content="2023-12-09" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Zhenjie Liu</h4>
<h4 class="date">2023-12-09</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="fu">library</span>(gridExtra)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="fu">library</span>(gt)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="fu">library</span>(latex2exp)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="fu">library</span>(boot)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="fu">library</span>(bootstrap)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    <span class="fu">library</span>(DAAG)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="fu">library</span>(coda)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    <span class="fu">library</span>(purrr)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    <span class="fu">library</span>(microbenchmark)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="fu">library</span>(Rcpp)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.2</code></pre>
<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="example1.-hello-world-program" class="section level2">
<h2>Example1. Hello World Program</h2>
<p>Here is a glimpse of objects in R programing.</p>
<div id="a.-vectors" class="section level3">
<h3>A. Vectors</h3>
<p>Vectors in R is a sequence of elements of the <strong>same</strong>
type.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>v1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>) <span class="co"># Integer vector</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>v2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;One&#39;</span>,<span class="st">&#39;Two&#39;</span>,<span class="st">&#39;3&#39;</span>) <span class="co"># Character Vector</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>v3 <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>) <span class="co"># Boolean Vector</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>v3[<span class="dv">1</span>] <span class="sc">==</span> <span class="cn">FALSE</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="b.-matrices" class="section level3">
<h3>B. Matrices</h3>
<p>Matrices is a two-dimensional object.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>my_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(data,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>my_matrix</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9</code></pre>
</div>
<div id="c.-dataframe" class="section level3">
<h3>C. Dataframe</h3>
<p>A dataframe object is similar to <code>pandas.dataframe</code> object
in <code>python</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>my_dataframe <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="st">&#39;idx&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="st">&#39;name&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="st">&#39;age&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">30</span>,<span class="dv">67</span>), <span class="st">&#39;married&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_dataframe)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">idx</th>
<th align="left">name</th>
<th align="right">age</th>
<th align="left">married</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">12</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">18</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">30</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">67</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="example2.-import-export-files" class="section level2">
<h2>Example2. Import &amp; Export Files</h2>
<div id="a.-excel-file" class="section level3">
<h3>A. Excel file</h3>
<p>Here we use <code>readxl</code> to import <code>.xlsx</code>
file.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Load readxl package</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># library(&#39;readxl&#39;)</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># df_excel = read_excel(&#39;./data/test.xlsx&#39;)</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># we can also use `read_xlsx` to import .xlsx file</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># knitr::kable(df_excel)</span></span></code></pre></div>
<p>Here we use <code>openxlsx</code> to export a Dataframe object to a
<code>.xlsx</code> file.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Load openxlsx package</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># library(&#39;openxlsx&#39;)</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># write.xlsx(my_dataframe,&#39;./data/export.xlsx&#39;,colNames = TRUE)</span></span></code></pre></div>
</div>
<div id="b.-csv-file" class="section level3">
<h3>B. CSV file</h3>
<p>Csv files are separated by <code>,</code>. To import or export a csv
file, we don’t need to install any r package.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># df_csv = read.csv(&#39;./data/test.csv&#39;)</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># knitr::kable(df_csv)</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># write.csv(my_dataframe, &quot;./data/export.csv&quot;, row.names = TRUE)</span></span></code></pre></div>
</div>
<div id="c.-txt-file" class="section level3">
<h3>C. Txt file</h3>
<p>Txt files are separated by <code>\t</code>. We can read a text file
by using <code>read.table()</code> into a DataFrame which is similar to
process the csv file.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># df_txt = read.table(&#39;./data/test.txt&#39;,sep=&#39;\t&#39;)</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># knitr::kable(df_txt)</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># write.table(my_dataframe, &quot;./data/export.txt&quot;, row.names = TRUE, sep=&quot;,&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="example3.-latex-formula-citation" class="section level2">
<h2>Example3. LaTex formula &amp; Citation</h2>
<div id="a.-latex-table" class="section level3">
<h3>A. LaTex table</h3>
<p>Here’s table example with citations.</p>
</div>
<div id="b.-latex-mathematical-formula" class="section level3">
<h3>B. LaTex mathematical formula</h3>
<p>The embedding and multi-head self-attention part in
<code>Transformer</code><span class="citation">[@Transformer]</span>
model can be formulated as follows: <span class="math display">\[\begin{equation}
  \begin{aligned}
    \mathbf{X}=Word\_Emb&amp;edding(\mathbf{X}_{input})+Positional\_Embedding(\mathbf{X}_{input})
\\
    \mathbf{X}_i=&amp;softmax(\frac{(\mathbf{XW_Q}_i)(\mathbf{XW_K}_i)^T}{\sqrt{d}})(\mathbf{XW_V}_i)
\\
    \mathbf{X}&amp;_{attention}=concat(\mathbf{X}_1,\mathbf{X}_2,\dots,\mathbf{X}_{n_{heads}})
  \end{aligned}
\end{equation}\]</span></p>
<p> Assme that <span class="math inline">\(X,X_1,\cdots,X_m\)</span> are
i.i.d, then: <span class="math display">\[\begin{equation}
        \mathbb{E}\left[\left(\frac{\sum_{i=1}^m X_i}{m}
-\mathbb{E}[X]\right)^2\right]=\frac{\mathbb{E}[X^2]-\mathbb{E}^2[X]}{m}\label{(3-3)}
\end{equation}\]</span></p>
<p> </p>
<p>Here’s an example of LaTex matrix. <span class="math display">\[
\begin{aligned}
\tilde{\boldsymbol{q}}_m = \boldsymbol{f}(\boldsymbol{q},
m)=&amp;\begin{pmatrix}q_0 \\ q_1 \\ q_2 \\ q_3 \\ \vdots \\ q_{d-2} \\
q_{d-1}
\end{pmatrix}\odot\begin{pmatrix}\cos m\theta_0 \\ \cos m\theta_0 \\
\cos m\theta_1 \\ \cos m\theta_1 \\ \vdots \\ \cos m\theta_{d/2-1} \\
\cos m\theta_{d/2-1}
\end{pmatrix} + \\&amp;
\begin{pmatrix}-q_1 \\ q_0 \\ -q_3 \\ q_2 \\ \vdots \\ -q_{d-1} \\
q_{d-2}
\end{pmatrix}\odot\begin{pmatrix}\sin m\theta_0 \\ \sin m\theta_0 \\
\sin m\theta_1 \\ \sin m\theta_1 \\ \vdots \\ \sin m\theta_{d/2-1} \\
\sin m\theta_{d/2-1}
\end{pmatrix}
\end{aligned}
\]</span></p>
</div>
</div>
<div id="example4.-figure-plot" class="section level2">
<h2>Example4. Figure &amp; Plot</h2>
<div id="a.-display-local-figure" class="section level3">
<h3>A. Display local figure</h3>
<p>To display a local figure in <code>Rmarkdown</code>, we can simply
use <code>![title](path)</code>. An Example is <code>Figure1</code> in
section <code>Example2</code>.</p>
<p>We can also use <code>knitr</code> to display pictures:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># knitr::include_graphics(&#39;./data/cat.jpg&#39;)</span></span></code></pre></div>
</div>
<div id="b.-plot-data" class="section level3">
<h3>B. Plot data</h3>
<p>We can use a scatter plot to plot numbers against each other. Here’s
an example.</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using <code>ggplot2</code> and <code>patchwork</code> is a more
general choice. Here we use <code>+</code> to plot many figures at the
same time.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(mpg, disp)) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Scatter plot&#39;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(gear, disp, <span class="at">group =</span> gear)) <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Box plot&#39;</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The following program plots the frequency histogram of the
continuously variable <code>area</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">x =</span> area))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Here we end with a normal distribution figure. We can use
<code>latex2exp</code> to use LaTex expressions when plotting.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    <span class="at">titie =</span> <span class="fu">TeX</span>(r<span class="st">&quot;($X \sim \mathcal{N}(0,1)$)&quot;</span>),</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&#39;X&#39;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">&#39;($f(x)=</span><span class="sc">\f</span><span class="st">rac{1}{ \sqrt[]{2\pi} } e^{-</span><span class="sc">\f</span><span class="st">rac{x^2}{2}}$)&#39;</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>Use the inverse transform method to implement the <code>sample</code>
function. Assume that <code>replace</code> is set to be
<code>True</code>.</p>
<div id="a.-analysis" class="section level4">
<h4>A. Analysis</h4>
To generate random samples from a probability vector <span class="math inline">\(P(X = x_i) = p_i\)</span>, we can:
<ol style="list-style-type: decimal">
<li>Generate <span class="math inline">\(U \sim \mathcal
U(0,1)\)</span></li>
<li>Determine the index <span class="math inline">\(k\)</span> such that
<span class="math inline">\(\sum_{j=1}^{k-1} p_j \leq U &lt;
\sum_{j=1}^k p_j\)</span> and return <span class="math inline">\(X=x_k\)</span>.</li>
</ol>
<p>For the first step, we can use <code>runif(1)</code> function, and we
use traverse search to search index <span class="math inline">\(k\)</span>.</p>
</div>
<div id="b.-code" class="section level4">
<h4>B. Code</h4>
<p>We implement the algorithm below.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>my_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="cn">NULL</span>){</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(size)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(prob)){ prob <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(data), <span class="at">times=</span><span class="fu">length</span>(data)) }</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="cf">for</span>( i <span class="cf">in</span> <span class="fu">seq_len</span>(size) ){</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    U  <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    <span class="cf">if</span>(U <span class="sc">&lt;=</span> prob[<span class="dv">1</span>]){</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    }</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    <span class="cf">for</span>( k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(prob) ) {</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">sum</span>(prob[<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)]) <span class="sc">&lt;</span> U <span class="sc">&amp;&amp;</span> U <span class="sc">&lt;=</span> <span class="fu">sum</span>(prob[<span class="dv">1</span><span class="sc">:</span>k]) )</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>        {samples[i] <span class="ot">&lt;-</span> k} </span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>    }</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  }</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="c.-example" class="section level4">
<h4>C. Example</h4>
<p>Here’s an example to use implemented function to generate random
samples. Assume that a discrete random variable <span class="math inline">\(X\)</span> follows the following distribution:</p>
<p>Below we simulate from this distribution using the
<code>my_sample</code> function defined above.</p>
<pre><code>## Don&#39;t know how to automatically pick scale for object of type &lt;table&gt;.
## Defaulting to continuous.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question2-exercises-3.2" class="section level2">
<h2>Question2 (Exercises 3.2)</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac
12e^{-|x|},\;x\in\mathbb{R}\)</span>.use the inverse transform method to
generate a random sample of size 1000 from this distribution. Use one of
the methods shown in this chapter to compare the generated sample to the
target distribution.</p>
<div id="a.-analysis-1" class="section level4">
<h4>A. Analysis</h4>
<p>The Laplace distribution’s cumulative distribution function is as
follows:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
F_X(x) &amp;= \int_{-\infty}^x \!\!f(u)\,\mathrm{d}u  = \begin{cases}
             \frac12 e^x &amp; \mbox{if }x \leq 0 \\
             1-\frac12 e^{-x} &amp; \mbox{if }x &gt; 0
            \end{cases} \\
&amp;=\frac{1}{2} + \frac{1}{2} \text{sign}(x) \left(1-e^{-|x|} \right)
\end{aligned}
\end{equation}\]</span></p>
<p>Solving for the inverse CDF, we get that:</p>
<p><span class="math display">\[\begin{equation}
F^{-1}_Y(y) = -\text{sign}(y-\frac{1}{2})\cdot \ln(1 - 2|y-\frac 12|)
\end{equation}\]</span></p>
</div>
<div id="b.-code-1" class="section level4">
<h4>B. Code</h4>
<p>We compare the histogram of our samples with the true density of
<span class="math inline">\(Y\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sign</span>(u<span class="dv">-1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">abs</span>(u<span class="dv">-1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Laplace Random Variable&quot;</span>, <span class="at">xlab=</span><span class="cn">NULL</span>) <span class="co">#density histogram of sample</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) , <span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="question3-exercises-3.7" class="section level2">
<h2>Question3 (Exercises 3.7)</h2>
<p>Write a function to generate a random sample of size n from the <span class="math inline">\(Beta(p, q)\)</span> distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the <span class="math inline">\(Beta(3,2)\)</span> distribution. Graph
the histogram of the sample with the theoretical <span class="math inline">\(Beta(3,2)\)</span> density superimposed.</p>
<div id="a.-analysis-2" class="section level4">
<h4>A. Analysis</h4>
<p>The beta distribution has density function: <span class="math display">\[\begin{equation}
\begin{aligned}
f_\beta(x)=\frac{1}{\text{B}(p,q)}x^{p-1}(1-x)^{q-1}\quad x\in [0,1]
\end{aligned}
\end{equation}\]</span></p>
<p>where the beta function <span class="math inline">\(\text
B(p,q)\)</span> is defined to be <span class="math display">\[\begin{equation}
\begin{aligned}
\text B(p,q)=\int_0^1 u^{p-1}(1-u)^{q-1}\text du
\end{aligned}
\end{equation}\]</span></p>
<p>Assume that <span class="math inline">\(g(x)\sim \mathcal
U(0,1)\)</span>, then we have <span class="math display">\[\begin{equation}
\begin{aligned}
\frac{f_\beta(x)}{g(x)}\leq \text B^{-1}(p,q)
\end{aligned}
\end{equation}\]</span></p>
<p>Then to randomly sample from <span class="math inline">\(f_\beta\)</span> we do: 1. Draw a candidate <span class="math inline">\(z\)</span> from <span class="math inline">\(g\)</span> and <span class="math inline">\(u\)</span> from <span class="math inline">\(\mathcal U(0,1)\)</span> 2. If <span class="math inline">\(u\leq f_\beta(z)/\text
B^{-1}(p,q)g(z)=z^{p-1}(1-z)^{q-1}\)</span>, return <span class="math inline">\(z\)</span>, else back to 1.</p>
</div>
<div id="b.-code-2" class="section level4">
<h4>B. Code</h4>
<p>Here we generate a random sample of size 1000 from the <span class="math inline">\(Beta(3,2)\)</span> distribution.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="cf">while</span>(k <span class="sc">&lt;</span> n){</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="cf">if</span>(u <span class="sc">&lt;</span> z<span class="sc">^</span>(p<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z)<span class="sc">^</span>(q<span class="dv">-1</span>)){</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>    samples[k] <span class="ot">&lt;-</span> z</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  }</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>}</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Beta Random Variable&quot;</span>, <span class="at">xlab=</span><span class="cn">NULL</span>)</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">12</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) , <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="question4-exercises-3.9" class="section level2">
<h2>Question4 (Exercises 3.9)</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function
<span class="math display">\[\begin{equation}
f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right),\quad |x|\leq 1
\end{equation}\]</span> Devroye and Györfi give the following algorithm
for simulation from this distribution. Generate iid <span class="math inline">\({U_{1}, U_{2}, U_{3} \sim \mathcal
U(-1,1)}\)</span>. If <span class="math inline">\({\left|U_{3}\right|
\geq}\)</span> <span class="math inline">\({\left|U_{2}\right|}\)</span>
and <span class="math inline">\({\left|U_{3}\right|
\geq\left|U_{1}\right|}\)</span>, deliver <span class="math inline">\({U_{2}}\)</span>; otherwise deliver <span class="math inline">\({U_{3}}\)</span>. Write a function to generate
random variates from <span class="math inline">\({f_{e}}\)</span>, and
construct the histogram density estimate of a large simulated random
sample.</p>
<div id="a.code" class="section level4">
<h4>A.Code</h4>
<p>The function below generate random variates from <span class="math inline">\(fe\)</span>, and then we plot the histogram
density of random samples.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>rek_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(n)){</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    <span class="cf">if</span> ((<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u2[i])) <span class="sc">&amp;&amp;</span> (<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u1[i])))</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> u2[i]</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>    <span class="cf">else</span> samples[i] <span class="ot">&lt;-</span> u3[i]</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>  }</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>}</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rek_sample</span>(<span class="dv">10000</span>)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>,  <span class="at">main=</span><span class="st">&quot;Rescaled Epanechnikov Kernel Sampling&quot;</span>, <span class="at">xlab=</span><span class="cn">NULL</span>)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>), <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="question5-exercises-3.10" class="section level2">
<h2>Question5 (Exercises 3.10)</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates
from the density <span class="math inline">\(f_e\)</span>.</p>
<p></p>
<p>The algorithm is equivalent to deliver the first or secontd order
value of <span class="math inline">\(|U_1|,|U_2|,|U_3|\)</span>. Assume
the deliver value is <span class="math inline">\(x\in [-1,1]\)</span>.
Let <span class="math inline">\(z_1=|U_1|,z_2=|U_2|,z_3=|U_3|\)</span>
are three independent rv from <span class="math inline">\(\mathcal
U[0,1]\)</span>, <span class="math inline">\(y=|x|\)</span>. Let the CDF
of delivering the kth order value is <span class="math display">\[\begin{equation}
F_k(z_k)=\sum_{i=k}^3 \text{C}_{3}^i (F(z_i))^i (1-F(z_i))^{3-i}
\end{equation}\]</span></p>
<p>Then the CDF of Y is <span class="math display">\[\begin{equation}
F_Y(y)=\frac 12 F_1(y)+\frac 12 F_2(y)=\frac 12(3y-y^2)
\end{equation}\]</span></p>
<p>thus the density of <span class="math inline">\(X\)</span> is <span class="math display">\[\begin{equation}
F_X(x)=\frac 12 F&#39;_Y(y)=\frac 34 (1-x^2),\quad x\in [-1,1]
\end{equation}\]</span></p>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question1.1" class="section level2">
<h2>Question1.1</h2>
<p>Proof that what value <span class="math inline">\(\rho=\frac
ld\)</span> should take to minimize the asymptotic variance of <span class="math inline">\(\hat \pi\)</span>? (<span class="math inline">\(m\sim\mathcal B(n,p)\)</span>, using <span class="math inline">\(\delta\)</span> method)</p>
<div id="answer" class="section level3">
<h3>Answer</h3>
<p>A plane has parallel lines on it at equal distances <span class="math inline">\(d\)</span> from each other. A needle of length
<span class="math inline">\(l\)</span> (<span class="math inline">\(l
\leq d\)</span>) is thrown at random on the plane. Let <span class="math inline">\(\rho=\frac ld\)</span>. As is well known, the
probabilities of crossing zero lines and one line are:</p>
<p><span class="math display">\[\begin{equation}
  \begin{aligned}
    p_0 &amp;= 1 - 2 \rho \theta\\
p_1 &amp;= 2 \rho \theta
  \end{aligned}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta=\frac 1\pi\)</span>.Let
<span class="math inline">\(m\)</span> be the number of times in <span class="math inline">\(n\)</span> independent tosses that the needle
crosses any line. The estimator of <span class="math inline">\(\pi\)</span>, <span class="math inline">\(\hat\pi=\frac{1}{\hat\theta}\)</span>, can be
formulated as <span class="math display">\[\begin{equation}
\hat\pi = \frac{2n\rho}{m}
\end{equation}\]</span></p>
<p>Applying the delta method shows that its asymptotic variance is:
<span class="math display">\[\begin{equation}
AVar(\hat \pi)=\frac{\pi^2}{2n}\left(\frac{\pi}{\rho}-2\right)
\end{equation}\]</span></p>
<p>which is, as expected, minimized at <span class="math inline">\(\rho
= 1\)</span>. For this value of <span class="math inline">\(\rho\)</span>, the asymptotic variance is <span class="math display">\[\begin{equation}
AVar(\hat \pi)=\frac{\pi^2}{2n}\left(\pi-2\right)
\end{equation}\]</span></p>
</div>
</div>
<div id="question1.2" class="section level2">
<h2>Question1.2</h2>
<p>Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0\leq
\rho\leq 1\)</span>, including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo
simulation to verify your answer. (<span class="math inline">\(n=10^6\)</span> , Number of repeated simulations K
= 100)</p>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>As illustrated in question1.1, <span class="math inline">\(\rho_{min}=1\)</span>, we take other two <span class="math inline">\(\rho_1=0.5,\rho_2=0.8\)</span> to verify it.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>rhos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>pis <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(rhos))){</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  l <span class="ot">&lt;-</span> rhos[i] <span class="sc">*</span> d</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(K)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_len</span>(K)){</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>    pihat <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>    estimates[j] <span class="ot">&lt;-</span> pihat</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  }</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  pis[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(estimates)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>  <span class="st">&#39;rho&#39;</span><span class="ot">=</span>rhos, <span class="st">&#39;estimate&#39;</span><span class="ot">=</span>pis</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">rho</th>
<th align="right">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">3.139485</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">3.148897</td>
</tr>
<tr class="odd">
<td align="right">0.8</td>
<td align="right">3.140688</td>
</tr>
</tbody>
</table>
<p>From the results above the best estimate is expected at <span class="math inline">\(\rho_{min}=1\)</span>.</p>
</div>
</div>
<div id="question2-exercises-5.6" class="section level2">
<h2>Question2 (Exercises 5.6)</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\begin{equation}
\theta = \int_{0}^1 e^x\text dx
\end{equation}\]</span> Now consider the antithetic variate approach.
Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim \mathcal U(0,1)\)</span>. What is the
percent reduction in variance of <span class="math inline">\(\hat
\theta\)</span> that can be achieved using antithetic variates (compared
with simple MC)?</p>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<p>The variances of <span class="math inline">\(e^U\)</span> and <span class="math inline">\(e^{1−U}\)</span> are equal because <span class="math inline">\(U\)</span> and <span class="math inline">\(1 −
U\)</span> are identically distributed. Then we have <span class="math display">\[\begin{equation}
  \begin{aligned}
Cov\left(e^{U}, e^{1-U}\right) &amp; = E\left[e^{U}
e^{1-U}\right]-E\left[e^{U}\right] E\left[e^{1-U}\right]
= e-(e-1)^{2}\\
Var\left(e^{U}+e^{1-U}\right) &amp; =2Var(e^U)= 2E\left[e^{2
U}\right]-2\left(E\left[e^{U}\right]\right)^{2}
=\left(e^{2}-1\right)-2(e-1)^{2}
  \end{aligned}
\end{equation}\]</span> Suppose <span class="math inline">\(\hat\theta_1\)</span> is the simple MC estimator
and <span class="math inline">\(\hat\theta_2\)</span> is the antithetic
estimator. Then if <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are iid Uniform (0,1) variables, we
have <span class="math display">\[\begin{equation}
Var\left(\frac{1}{2}\left(e^{U}+e^{V}\right)\right)=\frac{1}{4} \cdot2
\operatorname{Var}\left(e^{U}\right)=\frac{1}{2} \cdot
\frac{1}{2}\left(e^{2}-1-(e-1)^{2}\right)
\end{equation}\]</span></p>
<p>The reduction in variance is</p>
<p><span class="math display">\[\begin{equation}
\frac{Var\left(\hat{\theta}_{1}\right)-Var\left(\hat{\theta}_{2}\right)}{Var\left(\hat{\theta}_{1}\right)}
\approx 0.9676
\end{equation}\]</span></p>
</div>
</div>
<div id="question3-exercises-5.7" class="section level2">
<h2>Question3 (Exercises 5.7)</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>The R code for the empirical estimate of the percent reduction in
variance using the antithetic variate is as follows</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">exp</span>(<span class="fu">runif</span>(m)))</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>})</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>anti <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="fu">mean</span>((<span class="fu">exp</span>(u) <span class="sc">+</span> <span class="fu">exp</span>(v))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>})</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">var</span>(mc)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">var</span>(anti)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(mc), <span class="fu">mean</span>(anti)))</span></code></pre></div>
<pre><code>## [1] 1.71857 1.71829</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(v1, v2))</span></code></pre></div>
<pre><code>## [1] 2.477822e-05 8.080656e-07</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">print</span>((v1<span class="sc">-</span>v2)<span class="sc">/</span>v1)</span></code></pre></div>
<pre><code>## [1] 0.9673881</code></pre>
<p>In this simulation the reduction in variance printed on the last line
above is close to the theoretical value 0.9676 from Exercise 5.6.</p>
</div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="question1-exercises-5.13" class="section level2">
<h2>Question1 (Exercises 5.13)</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[\begin{equation}
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\quad x&gt;1
\end{equation}\]</span> Which of your two importance functions should
produce the smaller variance in estimating <span class="math display">\[\begin{equation}
\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\text dx
\end{equation}\]</span> by importance sampling? Explain.</p>
<div id="analysis" class="section level3">
<h3>Analysis</h3>
<p>Firstly, we display the graph of g(x).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>}</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>fun_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>}</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>fun_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="fu">dgamma</span>(x<span class="dv">-1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">/</span> <span class="fl">2.7</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>}</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>fun) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>fun_1, <span class="at">color=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>fun_2, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>    <span class="at">titie =</span> <span class="fu">TeX</span>(r<span class="st">&quot;($X \sim \mathcal{N}(0,1)$)&quot;</span>),</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&#39;X&#39;</span>,</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">&#39;($f(x)$)&#39;</span>)</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>From the graph, we might consider a normal distribution or a gamma
distribution. Where <span class="math display">\[\begin{equation}
\begin{aligned}
f_1(x) &amp;= \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\\
f_2(x) &amp;= \frac{f(x, \frac{3}{2}, 2)}{2.7}
\end{aligned}
\end{equation}\]</span></p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p><span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> are as above. We then compare the
variance in estimating (2).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>ie1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">rchisq</span>(m, <span class="dv">1</span>)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="dv">1</span>)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>})</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>ie2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(x<span class="dv">-1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">/</span> <span class="fl">2.7</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>})</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="fu">var</span>(ie1)<span class="sc">/</span><span class="fu">var</span>(ie2)</span></code></pre></div>
<pre><code>## [1] 0.02310146</code></pre>
<p>obviously, <span class="math inline">\(f_1\)</span> is much better
than <span class="math inline">\(f_2\)</span>.</p>
</div>
</div>
<div id="question2-exercises-5.14" class="section level2">
<h2>Question2 (Exercises 5.14)</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\begin{equation}
\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\text dx
\end{equation}\]</span> by importance sampling.</p>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>As illustrated in question1, we use <span class="math inline">\(\mathcal N(1, 1)\)</span> as the estimator. The MC
estimate of (4) is</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">integrate</span>(g, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
</div>
</div>
<div id="question3-exercises-5.15" class="section level2">
<h2>Question3 (Exercises 5.15)</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p>We use a importance function <span class="math display">\[\begin{equation}
f(x)=\frac{e^{-x}}{1-e^{-1}},\quad 0&lt;x&lt;1
\end{equation}\]</span> on five subintervals, <span class="math inline">\((j/5,(j + 1)/5), j = 0, 1,..., 4\)</span>. On the
<span class="math inline">\(j^{th}\)</span> subinterval <span class="math display">\[\begin{equation}
f_j(x)=f_{x|I_j}(x)=\frac{5e^{-x}}{1-e^{-1}},\quad
\frac{j-1}{5}&lt;x&lt;\frac{j}{5}
\end{equation}\]</span> Then the importance sampling estimate is</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>si <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (k<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>si[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>v[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(fg)</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>}</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(v))</span></code></pre></div>
<pre><code>## [1] 0.004167715</code></pre>
<p>Which is smaller than the estimate without stratification.</p>
</div>
</div>
<div id="question4-exercises-6.5" class="section level2">
<h2>Question4 (Exercises 6.5)</h2>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric
t-interval is applied to estimate a mean, but the sample data are
non-normal. Then the probability that the confidence interval covers the
mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to
estimate the coverage probability of the t-interval for random samples
of <span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n = 20\)</span>. Compare your t-interval
results with the simulation results in Example 6.4. (The t-interval
should be more robust to departures from normality than the interval for
variance.)</p>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p>We use a Monte Carlo experiment to estimate the coverage probability
of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>rootn <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="at">expr =</span> {</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x)<span class="sc">/</span>rootn</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>})</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> CI[<span class="dv">1</span>, ]</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> CI[<span class="dv">2</span>, ]</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="fu">sum</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 9144</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">mean</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9144</code></pre>
<p>The t-interval is more robust to departures from normality than the
interval for variance. <span class="math inline">\(\chi^2(2)\)</span>
distribution the empirical coverage rate was only <span class="math inline">\(77.3\%\)</span>.</p>
</div>
</div>
<div id="question5-exercises-6.a" class="section level2">
<h2>Question5 (Exercises 6.A)</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(\alpha\)</span>, when the
sampled population is non-normal. The t-test is robust to mild
departures from normality. Discuss the simulation results for the cases
where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) <span class="math inline">\(\mathcal U(0,2)\)</span>, and (iii)
Exponential(rate=1). In each case, test <span class="math inline">\(H_0:
\mu=\mu_0\)</span> vs <span class="math inline">\(H_0:\mu\neq
\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the
mean of <span class="math inline">\(\chi^2(1)\)</span>, <span class="math inline">\(\mathcal U(0,2)\)</span>, and Exponential(1),
respectively.</p>
<div id="analysis-1" class="section level3">
<h3>Analysis</h3>
<p>A Type I error occurs if the null hypothesis is rejected when in fact
the null hypothesis is true. An empirical Type I error rate can be
computed by a Monte Carlo experiment. The test procedure is replicated a
large number of times under the conditions of the null hypothesis. The
empirical Type I error rate for the Monte Carlo experiment is the sample
proportion of significant test statistics among the replicates. (Here we
use <span class="math inline">\(\alpha=0.05\)</span>)</p>
<p>First we take a look in <span class="math inline">\(\chi^2(1)\)</span>. The code for simulating <span class="math inline">\(n=10^4\)</span> is as follows</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> mu0)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  }</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>p<span class="fl">.1</span> <span class="ot">&lt;-</span><span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)  <span class="co"># Empirical Type-I Error</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>p<span class="fl">.1</span></span></code></pre></div>
<pre><code>## [1] 0.047</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">sqrt</span>(p<span class="fl">.1</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p<span class="fl">.1</span>) <span class="sc">/</span> m)  <span class="co"># SE</span></span></code></pre></div>
<pre><code>## [1] 0.006692608</code></pre>
<p>For the <span class="math inline">\(\mathcal U(0,2)\)</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>  }</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>p<span class="fl">.2</span> <span class="ot">&lt;-</span><span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)  <span class="co"># Empirical Type-I Error</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>p<span class="fl">.2</span></span></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">sqrt</span>(p<span class="fl">.2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p<span class="fl">.2</span>) <span class="sc">/</span> m)  <span class="co"># SE</span></span></code></pre></div>
<pre><code>## [1] 0.006892024</code></pre>
<p>For the <span class="math inline">\(\mathcal E(1)\)</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  }</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>p<span class="fl">.2</span> <span class="ot">&lt;-</span><span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)  <span class="co"># Empirical Type-I Error</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>p<span class="fl">.2</span></span></code></pre></div>
<pre><code>## [1] 0.054</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">sqrt</span>(p<span class="fl">.2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p<span class="fl">.2</span>) <span class="sc">/</span> m)  <span class="co"># SE</span></span></code></pre></div>
<pre><code>## [1] 0.007147307</code></pre>
<p>Compared the results above, the t-test is robust to mild departures
from normality. Thus, when the test procedure was replicated a large
number of times under the conditions of the null hypothesis <span class="math inline">\(H_0:\mu=\mu_0\)</span>, the observed Type I error
rate got closer to <span class="math inline">\(\alpha=0.05\)</span>.</p>
</div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<p>Consider 1000 hypotheses, where top 95% hypotheses’ null hypotheses
are accepted, and last 5% hypotheses’ alternative hypotheses are
accepted. Under null hypothesis, p-value obeys <span class="math inline">\(\mathcal U(0,1)\)</span>. And under alternative
hypothesis the p-value obeys <span class="math inline">\(\mathcal B(0.1,
1)\)</span>. Using bonferroni correction method and B-H correction
method to generate m corrected p-values. Comparing the results of
whether to reject null hypotheses assuming <span class="math inline">\(\alpha=0.1\)</span>.</p>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<p>We compute the FNER, FDR and TPR using the following code</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>get_corrected_p <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values, data){</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p_values)){</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>    <span class="cf">if</span>(p_values[i]<span class="sc">&lt;</span>alpha){</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>      <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="fl">0.95</span><span class="sc">*</span><span class="fu">length</span>(p_values)){</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>        data[<span class="dv">1</span>] <span class="ot">&lt;-</span> data[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>        data[<span class="dv">5</span>] <span class="ot">&lt;-</span> data[<span class="dv">5</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>      }</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>        data[<span class="dv">2</span>] <span class="ot">&lt;-</span> data[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>      }</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>    }</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>      <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="fl">0.95</span><span class="sc">*</span><span class="fu">length</span>(p_values)){</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>        data[<span class="dv">3</span>] <span class="ot">&lt;-</span> data[<span class="dv">3</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>      }</span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>        data[<span class="dv">4</span>] <span class="ot">&lt;-</span> data[<span class="dv">4</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>      }</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>    }</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>  }</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>}</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>get_data <span class="ot">&lt;-</span><span class="cf">function</span>(method){</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>) <span class="co"># FP, TP, TN, FN, FWER</span></span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">seq_len</span>(M)){</span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fl">0.95</span><span class="sc">*</span>m)){</span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>      p[i] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>    }</span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fl">0.05</span><span class="sc">*</span>m)){</span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a>      p[<span class="fl">0.95</span><span class="sc">*</span>m<span class="sc">+</span>i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1=</span><span class="fl">0.1</span>, <span class="at">shape2=</span><span class="dv">1</span>)</span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>    }</span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>    p_corrected <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method=</span>method)</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">get_corrected_p</span>(p_corrected, data)</span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>  }</span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>  </span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>}</span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a></span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a>report_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a>  FWER <span class="ot">&lt;-</span> <span class="fu">round</span>(data[<span class="dv">5</span>] <span class="sc">/</span> M, <span class="dv">3</span>)</span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a>  FDR <span class="ot">&lt;-</span> <span class="fu">round</span>(data[<span class="dv">1</span>] <span class="sc">/</span> (data[<span class="dv">1</span>]<span class="sc">+</span>data[<span class="dv">2</span>]), <span class="dv">3</span>)</span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a>  TPR <span class="ot">&lt;-</span> <span class="fu">round</span>(data[<span class="dv">2</span>] <span class="sc">/</span> (data[<span class="dv">2</span>]<span class="sc">+</span>data[<span class="dv">3</span>]), <span class="dv">3</span>)</span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(FWER, FDR, TPR))</span>
<span id="cb53-50"><a href="#cb53-50" tabindex="-1"></a>}</span>
<span id="cb53-51"><a href="#cb53-51" tabindex="-1"></a></span>
<span id="cb53-52"><a href="#cb53-52" tabindex="-1"></a>data_bonf <span class="ot">&lt;-</span> <span class="fu">report_data</span>(<span class="fu">get_data</span>(<span class="st">&#39;bonferroni&#39;</span>))</span>
<span id="cb53-53"><a href="#cb53-53" tabindex="-1"></a>data_bh <span class="ot">&lt;-</span> <span class="fu">report_data</span>(<span class="fu">get_data</span>(<span class="st">&#39;BH&#39;</span>))</span>
<span id="cb53-54"><a href="#cb53-54" tabindex="-1"></a></span>
<span id="cb53-55"><a href="#cb53-55" tabindex="-1"></a>my_dataframe <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-56"><a href="#cb53-56" tabindex="-1"></a>  <span class="st">&#39;Method&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;bonferroni&#39;</span>,<span class="st">&#39;BH&#39;</span>), <span class="st">&#39;FWER&#39;</span><span class="ot">=</span><span class="fu">c</span>(data_bonf[<span class="dv">1</span>],data_bh[<span class="dv">1</span>]),</span>
<span id="cb53-57"><a href="#cb53-57" tabindex="-1"></a>  <span class="st">&#39;FDR&#39;</span><span class="ot">=</span><span class="fu">c</span>(data_bonf[<span class="dv">2</span>],data_bh[<span class="dv">2</span>]),<span class="st">&#39;TPR&#39;</span><span class="ot">=</span><span class="fu">c</span>(data_bonf[<span class="dv">3</span>],data_bh[<span class="dv">3</span>])</span>
<span id="cb53-58"><a href="#cb53-58" tabindex="-1"></a>)</span>
<span id="cb53-59"><a href="#cb53-59" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_dataframe)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">FWER</th>
<th align="right">FDR</th>
<th align="right">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bonferroni</td>
<td align="right">0.102</td>
<td align="right">0.005</td>
<td align="right">0.021</td>
</tr>
<tr class="even">
<td align="left">BH</td>
<td align="right">2.981</td>
<td align="right">0.096</td>
<td align="right">0.029</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, the the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=1/\bar X\)</span>, where <span class="math inline">\(\bar X\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat
\lambda\)</span> is <span class="math inline">\(\lambda
n/(n-1)\)</span>, so that the estimation bias is <span class="math inline">\(\lambda/(n-1)\)</span>. The standard error <span class="math inline">\(\hat \lambda\)</span> is <span class="math inline">\(\lambda n/[(n-1)\sqrt{n-2}]\)</span>. Conduct a
simulation study to verify the performance of the bootstrap
method.Suppose that <span class="math inline">\(\lambda=2\)</span>, the
sample size <span class="math inline">\(n=5,10,20\)</span> respectively,
the number of bootstrap replicates <span class="math inline">\(B=1000\)</span>, the simulations times is <span class="math inline">\(m=1000\)</span>. Compare the mean bootstrap bias
and bootstrap standard error with the theoretical ones.</p>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<p>We compare the mean bootstrap bias and bootstrap standard error with
the theoretical ones by using the following code</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>get_theoretical_data <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples){</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="fu">round</span>(lambda<span class="sc">/</span>(num_samples<span class="dv">-1</span>), <span class="dv">3</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">round</span>(lambda<span class="sc">*</span>num_samples<span class="sc">/</span>((num_samples<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(num_samples<span class="dv">-2</span>)), <span class="dv">3</span>)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(bias, se))</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>}</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>mean_mle <span class="ot">&lt;-</span> <span class="cf">function</span>(samples,i){<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(samples[i])}</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>get_bootstrap_data <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples){</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="dv">0</span>; se <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_len</span>(m)){</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">rexp</span>(num_samples, <span class="at">rate=</span>lambda)</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>    boot_data <span class="ot">&lt;-</span> <span class="fu">boot</span>(samples, mean_mle, <span class="at">R=</span>B)</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>    bias <span class="ot">&lt;-</span> bias<span class="sc">+</span><span class="fu">mean</span>(boot_data<span class="sc">$</span>t)<span class="sc">-</span>boot_data<span class="sc">$</span>t0</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>    se <span class="ot">&lt;-</span> se<span class="sc">+</span><span class="fu">sd</span>(boot_data<span class="sc">$</span>t)</span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>  }</span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="fu">round</span>(bias<span class="sc">/</span>m, <span class="dv">3</span>); se <span class="ot">&lt;-</span> <span class="fu">round</span>(se<span class="sc">/</span>m, <span class="dv">3</span>)</span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(bias, se))</span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>}</span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>bias_T <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a>se_T <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>bias_b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a>se_b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(n))){</span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a>  num_samples <span class="ot">&lt;-</span> n[i]</span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a>  data_T <span class="ot">&lt;-</span> <span class="fu">get_theoretical_data</span>(num_samples)</span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a>  data_b <span class="ot">&lt;-</span> <span class="fu">get_bootstrap_data</span>(num_samples)</span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a>  bias_T[i] <span class="ot">&lt;-</span> data_T[<span class="dv">1</span>]; se_T[i] <span class="ot">&lt;-</span> data_T[<span class="dv">2</span>]</span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a>  bias_b[i] <span class="ot">&lt;-</span> data_b[<span class="dv">1</span>]; se_b[i] <span class="ot">&lt;-</span> data_b[<span class="dv">2</span>]</span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a>}</span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a>my_dataframe <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-37"><a href="#cb54-37" tabindex="-1"></a>  <span class="st">&#39;Samples_num&#39;</span><span class="ot">=</span>n, <span class="st">&#39;Bias_bootstrap&#39;</span><span class="ot">=</span>bias_b, <span class="st">&#39;Bias_theoretical&#39;</span><span class="ot">=</span>bias_T, <span class="st">&#39;SE_bootstrap&#39;</span><span class="ot">=</span>se_b, <span class="st">&#39;SE_theoretical&#39;</span><span class="ot">=</span>se_T</span>
<span id="cb54-38"><a href="#cb54-38" tabindex="-1"></a>)</span>
<span id="cb54-39"><a href="#cb54-39" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_dataframe)</span></code></pre></div>
<table>
<colgroup>
<col width="16%" />
<col width="20%" />
<col width="23%" />
<col width="18%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Samples_num</th>
<th align="right">Bias_bootstrap</th>
<th align="right">Bias_theoretical</th>
<th align="right">SE_bootstrap</th>
<th align="right">SE_theoretical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.603</td>
<td align="right">0.500</td>
<td align="right">2.195</td>
<td align="right">1.443</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.221</td>
<td align="right">0.222</td>
<td align="right">0.830</td>
<td align="right">0.786</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">0.103</td>
<td align="right">0.105</td>
<td align="right">0.496</td>
<td align="right">0.496</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="question3-exercises-7.3" class="section level2">
<h2>Question3 (Exercises 7.3)</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (<code>law data</code> in bootstrap).</p>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<p>The bootstrap t CI can be obtained using the boot.t.ci function. The
code is as following</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">attach</span>(law)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>cor.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) {</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="fu">cor</span>(x[i, <span class="dv">1</span>], x[i, <span class="dv">2</span>])</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>}</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>boot.t.ci <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">B =</span> <span class="dv">500</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">level =</span> <span class="fl">0.95</span>, statistic) {</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>  boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, f) {</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>    th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>    <span class="fu">f</span>(x[i, ])</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>    })</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  }</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[j, ]</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>    stat[b] <span class="ot">&lt;-</span> <span class="fu">statistic</span>(y)</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>    se[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(y, <span class="at">R =</span> R, <span class="at">f =</span> statistic)</span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  }</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>  stat0 <span class="ot">&lt;-</span> <span class="fu">statistic</span>(x)</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  t.stats <span class="ot">&lt;-</span> (stat <span class="sc">-</span> stat0)<span class="sc">/</span>se</span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  se0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat)</span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>  Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>  <span class="fu">names</span>(Qt) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(Qt))</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>  CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat0 <span class="sc">-</span> Qt <span class="sc">*</span> se0)</span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>}</span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.t.ci</span>(law, <span class="at">B =</span> <span class="dv">1000</span>, <span class="at">R =</span> <span class="dv">25</span>, <span class="at">statistic =</span> cor.stat))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.5075527  1.0056417</code></pre>
</div>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="question1-exercises-7.5" class="section level2">
<h2>Question1 (Exercises 7.5)</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<p>We first obtain the MLE of <span class="math inline">\(1/\lambda\)</span> (that is <span class="math inline">\(\bar x\)</span>) and use bootstrap to estimate the
bias and standard error of the estimate.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit[<span class="dv">1</span>]  <span class="co"># get data</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>meant <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ])))</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> meant, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = meant, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 -1.106583    35.85383</code></pre>
<p>The we obtain the 95% confidence intervals</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = b, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 38.9, 179.5 )   ( 29.2, 169.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.0, 187.0 )   ( 56.8, 211.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
</div>
<div id="question2-exercises-7.8" class="section level2">
<h2>Question2 (Exercises 7.8)</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat theta\)</span>.</p>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<p>We obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat theta\)</span> using the following code</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">attach</span>(scor)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(scor)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x[<span class="sc">-</span>i, ]</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">cov</span>(y)</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(s)<span class="sc">$</span>values</span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a>}</span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a><span class="fu">c</span>(theta.hat, bias.jack, se.jack)</span></code></pre></div>
<pre><code>## [1] 0.619115038 0.001069139 0.049552307</code></pre>
<p>From the results we can tell that the jackknife estimate of bias is
approximately 0.001 and the jackknife estimate of se is approximately
0.05.</p>
</div>
</div>
<div id="question3-exercises-7.11" class="section level2">
<h2>Question3 (Exercises 7.11)</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<p>We use the leave-two-out cv method to compare four models using the
code below</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># install.packages(&quot;DAAG&quot;)  # we first install DAAG package</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>ij <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>  e1[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>  e2[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>  e3[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>  e4[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a>  ij <span class="ot">&lt;-</span> ij <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>}</span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(e1), <span class="fu">sum</span>(e2), <span class="fu">sum</span>(e3), <span class="fu">sum</span>(e4))<span class="sc">/</span>N</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<p>Here we use leave-two-out cv method and choose the second model,
which is the same as the leave-one-out (n-fold) cv method.</p>
</div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<div id="proof" class="section level3">
<h3>Proof</h3>
<p>To proof the stationarity of the generated set <span class="math inline">\(\{X_i\}_{i=1}^N\)</span> by using M-H sampler
algorithm, we need to proof that <span class="math inline">\(\{X_i\}_{i=1}^N\)</span> satisfies the detailed
balance condition: <span class="math display">\[\begin{equation}
\forall i,j\in\mathcal S,\; f(i)K(i,j)=f(j)K(j,i)
\end{equation}\]</span></p>
<p>First, we proof that <span class="math inline">\(K(i,j)=g(Y=j|X_n=i)\cdot a(i,j)\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(i\neq j\)</span>, we have <span class="math display">\[\begin{equation}
  \begin{aligned}
g(X_{n+1} = j|X_n = i) &amp; = g(X_n = j|X_n = i)g(u\geq a(i,j))+g(Y =
j|X_n = i)g(u&lt;a(i,j))\\
&amp;=g(Y=j|X_n=i)g(u&lt;a(i,j))\\
&amp;=g(Y=j|X_n=i)\cdot a(i,j)
  \end{aligned}
\end{equation}\]</span></p></li>
<li><p><span class="math inline">\(i=j\)</span>, here we have <span class="math inline">\(a(i,j)=a(i,i)=1\)</span>, then <span class="math display">\[\begin{equation}
  \begin{aligned}
g(X_{n+1} = j|X_n = i) &amp; = g(X_n = j|X_n = i)g(u\geq a(i,j))+g(Y =
j|X_n = i)g(u&lt;a(i,j))\\
&amp;=g(u\geq a(i,j))+g(Y=j|X_n=i)g(u&lt;a(i,j))\\
&amp;=1-a(i,j)+g(Y=j|X_n=i)a(i,j)\\
&amp;=g(Y=j|X_n=i)a(i,j)
  \end{aligned}
\end{equation}\]</span></p></li>
</ol>
<p>Then we have <span class="math inline">\(K(i,j)=g(Y=j|X_n=i)\cdot
a(i,j)\)</span>. Now we proof the detailed balance condition <span class="math display">\[\begin{equation}
  \begin{aligned}
f(i)K(i,j)&amp;=f(i)g(Y=j|X_n=i)a(i,j)\\
&amp;=f(i)g(Y=j|X_n=i)\min\left(1,\frac{f(j)g(X_n=i|Y=j)}{f(i)g(Y=j|X_n=i)}\right)\\
&amp;=\min\left(f(i)g(Y=j|X_n=i),f(j)g(X_n=i|Y=j) \right)\\
&amp;=f(j)g(X_n=i|Y=j)\min\left(1,\frac{f(i)g(Y=j|X_n=i)}{f(j)g(X_n=i|Y=j)}\right)\\
&amp;=f(j)g(X_n=i|Y=j)a(j,i)=f(j)K(j,i)
  \end{aligned}
\end{equation}\]</span></p>
</div>
</div>
<div id="question2-exercises-8.1" class="section level2">
<h2>Question2 (Exercises 8.1)</h2>
<p>Implement the two-sample Cram’er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<p>The Cram’er-von Mises statistic, which estimates the integrated
squared distance between the distributions, is defined by <span class="math display">\[\begin{equation}
{W_{2}=\frac{m
n}{(m+n)^{2}}\left[\sum_{i=1}^{n}\left(F_{n}\left(x_{i}\right)-G_{m}\left(x_{i}\right)\right)^{2}+\sum_{j=1}^{m}\left(F_{n}\left(y_{j}\right)-G_{m}\left(y_{j}\right)\right)^{2}\right]}
\end{equation}\]</span></p>
<p>We implement it using the following code</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>my.cvm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">999</span>) {</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x))</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> y))</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  }</span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>  cvm0 <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>  cvm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> z[k]</span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Z[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> Z[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> X))</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> Y))</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  }</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>  ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a>  })</span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a>cvm1 <span class="ot">&lt;-</span> <span class="fu">c</span>(cvm, cvm0)</span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">statistic =</span> cvm0, <span class="at">p.value =</span> <span class="fu">mean</span>(cvm1 <span class="sc">&gt;=</span> cvm0)))</span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a><span class="fu">my.cvm</span>(x, y)</span></code></pre></div>
<pre><code>## $statistic
## [1] 4.228022
## 
## $p.value
## [1] 0.373</code></pre>
<p>From the results above we can tell that there is not evidence of a
difference between the soybean and linseed groups.</p>
</div>
</div>
<div id="question3-exercises-8.3" class="section level2">
<h2>Question3 (Exercises 8.3)</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<p>Here’s a implementation of a premutation test for equal variace which
supports different numbers of sample size.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>maxoutliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>}</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>my.maxoutliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">999</span>) {</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(z)</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>    k1 <span class="ot">&lt;-</span> k[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>    k2 <span class="ot">&lt;-</span> k[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>    <span class="fu">maxoutliers</span>(z[k1], z[k2])</span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>  })</span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">maxoutliers</span>(x, y)</span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a>  stats1 <span class="ot">&lt;-</span> <span class="fu">c</span>(stats, stat)</span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(stats1)<span class="sc">/</span>(R <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> stat, <span class="at">p =</span> <span class="fu">mean</span>(stats1 <span class="sc">&gt;=</span> stat), <span class="at">freq =</span> tab, <span class="at">cdf =</span> <span class="fu">cumsum</span>(tab)))</span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we provide a example to test our implementation. Consider the
case of two independent random samples from the same normal distribution
with different variances.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu, sigma1)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu, sigma2)</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a><span class="fu">my.maxoutliers</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 31
## 
## $p
## [1] 0.107
## 
## $freq
## stats1
##     1     2     3     4     5     6     7     8     9    10    11    12    13 
## 0.012 0.020 0.034 0.049 0.015 0.031 0.053 0.021 0.041 0.031 0.066 0.039 0.041 
##    14    15    16    17    18    19    20    21    22    23    24    25    26 
## 0.020 0.039 0.036 0.049 0.039 0.029 0.027 0.018 0.027 0.017 0.025 0.019 0.014 
##    27    28    29    30    31    32    33    34    35    36    37    38    39 
## 0.021 0.021 0.018 0.021 0.013 0.011 0.018 0.009 0.006 0.004 0.003 0.002 0.003 
##    40    41    42    44    45    46    48    49    51    54    56    59    60 
## 0.005 0.004 0.004 0.004 0.002 0.005 0.001 0.002 0.001 0.002 0.001 0.003 0.002 
##    61    63 
## 0.001 0.001 
## 
## $cdf
##     1     2     3     4     5     6     7     8     9    10    11    12    13 
## 0.012 0.032 0.066 0.115 0.130 0.161 0.214 0.235 0.276 0.307 0.373 0.412 0.453 
##    14    15    16    17    18    19    20    21    22    23    24    25    26 
## 0.473 0.512 0.548 0.597 0.636 0.665 0.692 0.710 0.737 0.754 0.779 0.798 0.812 
##    27    28    29    30    31    32    33    34    35    36    37    38    39 
## 0.833 0.854 0.872 0.893 0.906 0.917 0.935 0.944 0.950 0.954 0.957 0.959 0.962 
##    40    41    42    44    45    46    48    49    51    54    56    59    60 
## 0.967 0.971 0.975 0.979 0.981 0.986 0.987 0.989 0.990 0.992 0.993 0.996 0.998 
##    61    63 
## 0.999 1.000</code></pre>
<p>From the observed statistic above, is significant.</p>
</div>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="question1-3" class="section level2">
<h2>Question1</h2>
<p>Consider a model <span class="math inline">\(P(Y=1|X1,X_2,X_3)=\frac{\exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+\exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>,
where <span class="math inline">\(X_1\sim \mathcal P(1), X_2\sim
\mathcal E(1),X_3\sim\mathcal B(1,\frac 12)\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Design a function that takes as input values <span class="math inline">\(N, b_1, b_2, b_3,f_0\)</span>, and produces the
output <span class="math inline">\(a\)</span>.</p></li>
<li><p>Call this function, input values are <span class="math inline">\(N=1e6,
b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>.</p></li>
<li><p>Plot <span class="math inline">\(-log f_0\)</span> vs <span class="math inline">\(a\)</span>.</p></li>
</ol>
<div id="analysis-2" class="section level3">
<h3>Analysis</h3>
<p>It’s hard to solve <span class="math inline">\(a\)</span>
analytically: <span class="math display">\[\begin{equation}
  P(Y=1)=\mathbb{E}[P(Y=1|X_1,X_2,X_3)]
\end{equation}\]</span></p>
<p>The prevalence <span class="math inline">\(P(Y=1)\)</span> is a
funtion of <span class="math inline">\(a\)</span> given the other
parameters and distribution of <span class="math inline">\((X_1,X_2,X_3)\)</span>, here we donate <span class="math inline">\(f(a)=P(Y=1;X_1,X_2,X_3,b_1,b_2,b_3)\)</span>. Then
the problem becomes solving <span class="math inline">\(f(a)=f_0\)</span>. We use <code>uniroot</code>
function to find the root of <span class="math inline">\(f(a)-f_0=0\)</span> by using <span class="math display">\[\begin{equation}
  g(a)=\frac 1N \sum_{i=1}^N
\frac{1}{1+\exp(-a-b_1x_1-b_2x_2-b_3x_3)}-f_0
\end{equation}\]</span></p>
</div>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<p>The function that takes as input values <span class="math inline">\(N, b_1, b_2, b_3,f_0\)</span> and produces the
output <span class="math inline">\(a\)</span> is as follows</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>b2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>my.solution <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="at">lambda=</span><span class="dv">1</span>)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>  }</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">0</span>))</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>}</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(f))</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(f))){</span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">my.solution</span>(N,b1,b2,b3,<span class="at">f0=</span>f[i])</span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>}</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1]  -3.165153  -6.071678  -8.725390 -11.243276</code></pre>
<p>Then we plot <span class="math inline">\(-\log_{10} f_0\)</span> vs
<span class="math inline">\(a\)</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-1</span>, <span class="fl">1e-4</span>, <span class="at">length=</span><span class="fl">1e4</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(f))</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(f))){</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">my.solution</span>(<span class="at">N=</span><span class="fl">1e4</span>,b1,b2,b3,<span class="at">f0=</span>f[i])</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>}</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;-log f_0&#39;</span><span class="ot">=</span><span class="sc">-</span><span class="fu">log</span>(f,<span class="dv">10</span>),<span class="st">&#39;a&#39;</span><span class="ot">=</span>a)</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fu">log</span>(f,<span class="dv">10</span>),<span class="at">y=</span>a)) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">titie =</span> <span class="fu">TeX</span>(r<span class="st">&quot;($-\log f_0\; v.s\; a$)&quot;</span>), </span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>     <span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">&#39;($-\log f_0$)&#39;</span>), <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">&#39;($a$)&#39;</span>))</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="question2-exercises-9.4" class="section level2">
<h2>Question2 (Exercises 9.4)</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<p>The standard Laplace density is <span class="math display">\[\begin{equation}
  f(x)=\frac{1}{2} e^{-|x|}
\end{equation}\]</span></p>
<p>The random walk sampler is implemented as following</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>my.random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, sigma) {</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  accept_num <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(xt) <span class="sc">-</span> <span class="fu">abs</span>(y))){</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>      accept_num <span class="ot">=</span> accept_num <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>    }</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>  }</span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">acceptance_rate=</span>accept_num<span class="sc">/</span>N))</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>}</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">my.random_walk</span>(N, x0, <span class="at">sigma=</span><span class="fl">0.1</span>)</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">my.random_walk</span>(N, x0, <span class="at">sigma=</span><span class="dv">1</span>)</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">my.random_walk</span>(N, x0, <span class="at">sigma=</span><span class="dv">2</span>)</span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">my.random_walk</span>(N, x0, <span class="at">sigma=</span><span class="dv">5</span>)</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>acceptance_rate, rw2<span class="sc">$</span>acceptance_rate, rw3<span class="sc">$</span>acceptance_rate, rw4<span class="sc">$</span>acceptance_rate))</span></code></pre></div>
<pre><code>## [1] 0.9624 0.6965 0.5192 0.2868</code></pre>
<p>Where <code>N</code> is length of the chain, <code>x[1]=x0</code> is
the initial value, and the <code>sigma</code> donates the standard
deviation of the normal proposal distribution. At each step, the
candidate point is generated from <span class="math inline">\(\mathcal
N(\mu_t,\sigma^2\)</span>, where <span class="math inline">\(\mu_t\)</span> is the previous value in the chain.
The function returns the generated chain <code>x</code> and the
acceptance rate.</p>
<p>Then we plot the histogram of each charin
<img src="data:image/png;base64,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" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" style="display: block; margin: auto;" />
We can draw the conclusion that the second chain (<span class="math inline">\(\sigma=1\)</span>) is the most efficient one.</p>
</div>
</div>
<div id="question3-exercises-9.7" class="section level2">
<h2>Question3 (Exercises 9.7)</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = \beta_0 + \beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<p>We implement the Gibbs sampler as follows</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="fl">0.9</span>  <span class="co"># correlation</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># zero-means</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> corr<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> corr<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> corr <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> corr <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>}</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>X <span class="ot">&lt;-</span> x[, <span class="dv">1</span>]</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>Y <span class="ot">&lt;-</span> x[, <span class="dv">2</span>]</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.63551 -0.29664  0.00196  0.29961  1.81102 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.002008   0.006884   0.292    0.771    
## X           0.907617   0.006824 132.995   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4354 on 3998 degrees of freedom
## Multiple R-squared:  0.8156, Adjusted R-squared:  0.8156 
## F-statistic: 1.769e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The residual plots is as follows
<img src="data:image/png;base64,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" style="display: block; margin: auto;" />
## Question4 (Exercises 9.10) Refer to Example 9.1. Use the Gelman-Rubin
method to monitor convergence of the chain, and run the chain until the
chain has converged approximately to the target distribution according
to <span class="math inline">\(\hat R &lt; 1.2\)</span>. (See Exercise
9.9.) Also use the coda package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions <code>gelman.diag</code>, <code>gelman.plot</code>,
<code>a</code>s.mcmc<code>, and</code>mcmc.list`.</p>
</div>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<p>First we use the Gelman-Rubin method to monitor convergence of the
Rayleigh M-H chain.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>}</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){  <span class="co"># Gelman-Rubin convergence monitoring</span></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>  <span class="co"># We Modify the Gelman-Rubin convergence monitoring so that only the final value of $\hat R$ is computed</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>  vhat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)</span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> vhat<span class="sc">/</span>W</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>  <span class="fu">return</span>(rhat)</span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a>}</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a></span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>my.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, m, x0) {</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den)</span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a>    <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a>  }</span>
<span id="cb78-34"><a href="#cb78-34" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb78-35"><a href="#cb78-35" tabindex="-1"></a>}</span>
<span id="cb78-36"><a href="#cb78-36" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb78-37"><a href="#cb78-37" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span>sigma, sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb78-38"><a href="#cb78-38" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb78-39"><a href="#cb78-39" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb78-40"><a href="#cb78-40" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb78-41"><a href="#cb78-41" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) X[i, ] <span class="ot">&lt;-</span> <span class="fu">my.chain</span>(sigma, m,x0[i])</span>
<span id="cb78-42"><a href="#cb78-42" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb78-43"><a href="#cb78-43" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) psi[i, ] <span class="ot">&lt;-</span> psi[i, ]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb78-44"><a href="#cb78-44" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb78-45"><a href="#cb78-45" tabindex="-1"></a>rhat</span></code></pre></div>
<pre><code>## [1] 1.180343</code></pre>
<p>Then we use the functions from <code>coda</code> package.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># install `coda` package</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a><span class="co"># install.packages(&quot;coda&quot;, repos = &quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;)</span></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">1</span>, ])</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">2</span>, ])</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">3</span>, ])</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">4</span>, ])</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(X1, X2, X3, X4)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(Y))  <span class="co"># Gelman-Rubin diagnostic function</span></span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1       1.01</code></pre>
</div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="question1-exercises-11.8" class="section level2">
<h2>Question1 (Exercises 11.8)</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute <code>B &lt;- A + 2</code>, find
the solution of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also find the value of game A
and game B.</p>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<p>The solution code of game B is as follows</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>my.solution <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>  <span class="co"># we follow the example function of Example 11.7.</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A  <span class="co"># so that v &gt;= 0</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>  max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A<span class="sc">/</span><span class="fu">max</span>(A)</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co"># objective function</span></span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3, <span class="at">maxi =</span> <span class="cn">TRUE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co"># constraints sum(x)=1</span></span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3, <span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>    <span class="at">A =</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A, </span>
<span id="cb82-24"><a href="#cb82-24" tabindex="-1"></a>    <span class="at">x =</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb82-25"><a href="#cb82-25" tabindex="-1"></a>    <span class="at">y =</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n], </span>
<span id="cb82-26"><a href="#cb82-26" tabindex="-1"></a>    <span class="at">v =</span> sx<span class="sc">$</span>soln[m <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span>min.A)</span>
<span id="cb82-27"><a href="#cb82-27" tabindex="-1"></a>  <span class="co"># returns in a list, the payoff matrix, optimal strategies, and the value of the game</span></span>
<span id="cb82-28"><a href="#cb82-28" tabindex="-1"></a>  solution</span>
<span id="cb82-29"><a href="#cb82-29" tabindex="-1"></a>}</span>
<span id="cb82-30"><a href="#cb82-30" tabindex="-1"></a><span class="co"># enter the payoff matrix</span></span>
<span id="cb82-31"><a href="#cb82-31" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb82-32"><a href="#cb82-32" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb82-33"><a href="#cb82-33" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">my.solution</span>(B)</span>
<span id="cb82-34"><a href="#cb82-34" tabindex="-1"></a></span>
<span id="cb82-35"><a href="#cb82-35" tabindex="-1"></a><span class="co"># get optimal strategies</span></span>
<span id="cb82-36"><a href="#cb82-36" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co"># get value of the game</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>s<span class="sc">$</span>v</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<p>The results above indicate that the value of the game is <span class="math inline">\(v=2\)</span>.</p>
</div>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="question1-2.1.3-exercise-4" class="section level2">
<h2>Question1 (2.1.3 Exercise 4)</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<div id="answer-21" class="section level3">
<h3>Answer</h3>
<p>Atomic vectors are defined in Advanced R as objects of type logical,
integer, double, complex, character or raw. Vectors are defined as
atomic vectors or lists. Thus a list is already a vector, though not an
atomic vector.</p>
</div>
</div>
<div id="question2-2.3.1-exercise-1" class="section level2">
<h2>Question2 (2.3.1 Exercise 1)</h2>
<p>What does <code>dim()</code> return when applied to a vector?</p>
<div id="answer-22" class="section level3">
<h3>Answer</h3>
<p><code>dim()</code> will return NULL when applied to a (1d)
vector.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
</div>
<div id="question3-2.3.1-exercise-2" class="section level2">
<h2>Question3 (2.3.1 Exercise 2)</h2>
<p>If <code>is.matrix(x)</code> is TRUE, what will
<code>is.array(x)</code> return?</p>
<div id="answer-23" class="section level3">
<h3>Answer</h3>
<p><code>is.array()</code> will return TRUE, for <code>matrix</code> is
a special case of <code>array</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">is.matrix</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">is.array</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="question4-2.4.5-exercise-2" class="section level2">
<h2>Question4 (2.4.5 Exercise 2)</h2>
<p>What does <code>as.matrix()</code> do when applied to a data frame
with columns of different types?</p>
<div id="answer-24" class="section level3">
<h3>Answer</h3>
<p><code>as.matrix()</code> depends on the types of the input columns.
It is a generic function. The method for data frames will return a
character matrix if there is only atomic columns and any
non-(numeric/logical/complex) column, applying as.vector to factors and
format to other non-character columns. Otherwise, the usual coercion
hierarchy (logical &lt; integer &lt; double &lt; complex) will be used,
e.g., all-logical data frames will be coerced to a logical matrix, mixed
logical-integer will give a integer matrix, etc.</p>
<p>While <code>data.matrix</code> will always return a numeric matrix.
Items will be replaced by it’s codes (similar to
<code>LabelEncoding</code> in python).</p>
</div>
</div>
<div id="question5-2.4.5-exercise-3" class="section level2">
<h2>Question5 (2.4.5 Exercise 3)</h2>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<div id="answer-25" class="section level3">
<h3>Answer</h3>
<p>Both 0-rows and 0-columns data frame are allowed. An example is as
folowing</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># 0-rows data frame</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">integer</span>(), <span class="at">b =</span> <span class="fu">logical</span>())</span></code></pre></div>
<pre><code>## [1] a b
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co"># 0-columns data frame</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## data frame with 0 columns and 3 rows</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># empty data frame with both 0 rows and 0 columns</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a><span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
</div>
</div>
<div id="question6-11.1.2-exercise-2" class="section level2">
<h2>Question6 (11.1.2 Exercise 2)</h2>
<p>The function below scales a vector so it falls in the range <span class="math inline">\([0,1]\)</span>. How would you apply it to every
column of a data frame? How would you apply it to every numeric column
in a data frame?</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>}</span></code></pre></div>
<div id="answer-26" class="section level3">
<h3>Answer</h3>
<p>To apply a function to every column of a data frame, we can use
<code>purrr::modify()</code>, which also conveniently returns a data
frame. To limit the application to numeric columns, the scoped version
<code>modify_if()</code> can be used.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>numeric_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>,<span class="fl">0.5</span>),</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>)</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>,<span class="fl">0.5</span>),</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>)</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">modify</span>(numeric_df, scale01)</span></code></pre></div>
<pre><code>##     a         b
## 1 0.0 0.0000000
## 2 1.0 0.3333333
## 3 0.4 1.0000000</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">modify_if</span>(df, is.numeric, scale01)</span></code></pre></div>
<pre><code>##   a   b         c
## 1 a 0.0 0.0000000
## 2 b 1.0 0.3333333
## 3 c 0.4 1.0000000</code></pre>
</div>
</div>
<div id="question7-11.2.5-exercise-1" class="section level2">
<h2>Question7 (11.2.5 Exercise 1)</h2>
<p>Use <code>vapply()</code> to: a) Compute the standard deviation of
every column in a numeric data frame. b) Compute the standard deviation
of every numeric column in a mixed data frame. (Hint: you’ll need to use
<code>vapply()</code> twice.)</p>
<div id="answer-27" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: lower-alpha">
<li>Compute the sd of a numeric data frame</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">vapply</span>(numeric_df, sd, <span class="at">FUN.VALUE=</span><span class="fl">1.0</span>)</span></code></pre></div>
<pre><code>##         a         b 
## 0.2516611 0.7637626</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every numeric column in a mixed
data frame</li>
</ol>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df, is.numeric, <span class="cn">TRUE</span>)], sd, <span class="fl">1.0</span>)</span></code></pre></div>
<pre><code>##         b         c 
## 0.2516611 0.7637626</code></pre>
</div>
</div>
<div id="question8" class="section level2">
<h2>Question8</h2>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section) a) Write an R
function. b) Write an Rcpp function. c) Compare the computation time of
the two functions with the function “microbenchmark”.</p>
<div id="answer-28" class="section level3">
<h3>Answer</h3>
<p>For a bivariate distribution <span class="math inline">\((X,
Y)\)</span>, at each iteration the Gibbs sampler:</p>
<ol style="list-style-type: decimal">
<li><p>Generate <span class="math inline">\(X^*(t)\)</span> from <span class="math inline">\(\mathcal B(n, p=Y(t-1))\)</span></p></li>
<li><p>Update <span class="math inline">\(x(t)=X^*(t)\)</span></p></li>
<li><p>Generate <span class="math inline">\(Y^*(t)\)</span> from <span class="math inline">\(\mathcal{Beta}(x(t)+a, n-x(t)+b)\)</span></p></li>
<li><p>Set <span class="math inline">\((X(t),Y(t))=(X^*(t),Y^*(t))\)</span></p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>R function</li>
</ol>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>gibbs.R <span class="ot">&lt;-</span> <span class="cf">function</span>(N, burn, a,b,n){</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>  <span class="co"># initialization</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> n)</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> x[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> y[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">size =</span> n)</span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>  }</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  xb <span class="ot">&lt;-</span> x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">table</span>(xb)<span class="sc">/</span><span class="fu">length</span>(xb))</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>}</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a>samples.R <span class="ot">&lt;-</span> <span class="fu">gibbs.R</span>(<span class="at">N=</span><span class="fl">1e5</span>, <span class="at">burn=</span><span class="dv">2000</span>, <span class="at">a=</span><span class="dv">2</span>, <span class="at">b=</span><span class="dv">3</span>, <span class="at">n=</span><span class="dv">10</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>RCPP function</li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39; </span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="st">Rcpp::NumericVector gibbs_rcpp(int N, int burn, int a, int b, int n) { </span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="st">  NumericVector x (N);  // x &lt;- y &lt;- rep(0, N)</span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a><span class="st">  NumericVector y (N);</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a><span class="st">  x[0] = Rcpp::rbinom(1, n, 0.5)[0];</span></span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a><span class="st">  y[0] = Rcpp::rbeta(1, x[1] + a, n - x[1] + b)[0];</span></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a><span class="st">    x[i] = Rcpp::rbinom(1, n, y[i - 1])[0];</span></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a><span class="st">    y[i] = Rcpp::rbeta(1, x[i] + a, n - x[i] + b)[0];</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a><span class="st">  NumericVector xb = x[Rcpp::Range(burn + 1,N)];</span></span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a><span class="st">  NumericVector f (Rcpp::table(xb).length());</span></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a><span class="st">  for(int i=1;i&lt;table(xb).length();i++){</span></span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a><span class="st">    f[i] = float(table(xb)[i]) / (N-burn);</span></span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a><span class="st">  return f;</span></span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">gibbs_rcpp</span>(<span class="at">N=</span><span class="fl">1e5</span>, <span class="at">burn=</span><span class="dv">2000</span>, <span class="at">a=</span><span class="dv">2</span>, <span class="at">b=</span><span class="dv">3</span>, <span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a>s</span></code></pre></div>
<pre><code>##  [1] 0.00000000 0.06603061 0.11210204 0.13596939 0.14373469 0.13923469
##  [7] 0.12373469 0.10457143 0.07944898 0.05420408 0.02983673 0.01112245</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Compare these two functions by using
<code>microbenchmark</code></li>
</ol>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">gibbs.R</span>(N, burn, a,b,n), <span class="fu">gibbs_rcpp</span>(N, burn, a,b,n))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                          expr      min        lq      mean   median        uq
##     gibbs.R(N, burn, a, b, n) 261.2955 269.39385 275.15436 272.0947 275.95145
##  gibbs_rcpp(N, burn, a, b, n)  46.1312  48.97865  51.54921  50.1925  51.88165
##       max neval
##  326.1544   100
##  104.6681   100</code></pre>
<p>From the results above we can draw the conclusion that the Rcpp
function is much more faster than the R version.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
